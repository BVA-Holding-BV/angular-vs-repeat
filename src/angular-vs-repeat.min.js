//
// Copyright Kamil PÄ™kala http://github.com/kamilkp
// Angular Virtual Scroll Repeat v1.1.7 2016/03/08
//
!function(a,b){"use strict";function c(){if("pageYOffset"in a)return{scrollTop:pageYOffset,scrollLeft:pageXOffset};var b,c,d=document,e=d.documentElement,f=d.body;return b=e.scrollLeft||f.scrollLeft||0,c=e.scrollTop||f.scrollTop||0,{scrollTop:c,scrollLeft:b}}function d(b,c){return b===a?"clientWidth"===c?a.innerWidth:a.innerHeight:b[c]}function e(b,d){return b===a?c()[d]:b[d]}function f(b,d,e){return b.getBoundingClientRect()[e?"left":"top"]-(d===a?0:d.getBoundingClientRect()[e?"left":"top"])+(d===a?c():d)[e?"scrollLeft":"scrollTop"]}var g=document.documentElement,h=g.matches?"matches":g.matchesSelector?"matchesSelector":g.webkitMatches?"webkitMatches":g.webkitMatchesSelector?"webkitMatchesSelector":g.msMatches?"msMatches":g.msMatchesSelector?"msMatchesSelector":g.mozMatches?"mozMatches":g.mozMatchesSelector?"mozMatchesSelector":null,i=b.element.prototype.closest||function(a){for(var c=this[0].parentNode;c!==document.documentElement&&null!=c&&!c[h](a);)c=c.parentNode;return c&&c[h](a)?b.element(c):b.element()},j=b.module("vs-repeat",[]).directive("vsRepeat",["$compile","$parse",function(c,g){return{restrict:"A",scope:!0,compile:function(h,j,k){var l,m,n,o,p,q,r=b.isDefined(j.vsRepeatContainer)?b.element(h[0].querySelector(j.vsRepeatContainer)):h,s=r.children().eq(0),t=s[0].outerHTML,u="$vs_collection",v=!1,w={vsRepeat:"elementSize",vsOffsetBefore:"offsetBefore",vsOffsetAfter:"offsetAfter",vsScrolledToEndOffset:"scrolledToEndOffset",vsScrolledToBeginningOffset:"scrolledToBeginningOffset",vsExcess:"excess"};if(s.attr("ng-repeat"))q="ng-repeat",l=s.attr("ng-repeat");else if(s.attr("data-ng-repeat"))q="data-ng-repeat",l=s.attr("data-ng-repeat");else if(s.attr("ng-repeat-start"))v=!0,q="ng-repeat-start",l=s.attr("ng-repeat-start");else{if(!s.attr("data-ng-repeat-start"))throw new Error("angular-vs-repeat: no ng-repeat directive on a child element");v=!0,q="data-ng-repeat-start",l=s.attr("data-ng-repeat-start")}if(m=/^\s*(\S+)\s+in\s+([\S\s]+?)(track\s+by\s+\S+)?$/.exec(l),n=m[1],o=m[2],p=m[3],v)for(var x=0,y=r.children().eq(0);null==y.attr("ng-repeat-end")&&null==y.attr("data-ng-repeat-end");)x++,y=r.children().eq(x),t+=y[0].outerHTML;return r.empty(),{pre:function(h,j,l,m){function r(){if(!I||I.length<1)h[u]=[],E=0,h.sizesCumulative=[0];else if(E=I.length,N){h.sizes=I.map(function(a){var c=h.$new(!1);b.extend(c,a),c[n]=a;var d=l.vsSize||l.vsSizeProperty?c.$eval(l.vsSize||l.vsSizeProperty):h.elementSize;return c.$destroy(),d});var a=0;h.sizesCumulative=h.sizes.map(function(b){var c=a;return a+=b,c}),h.sizesCumulative.push(a)}else s();A()}function s(){M&&h.$$postDigest(function(){if(F[0].offsetHeight||F[0].offsetWidth){for(var a=F.children(),b=0,c=!1,d=!1;b<a.length;){if(null!=a[b].attributes[q]||d){if(c||(h.elementSize=0),c=!0,a[b][R]&&(h.elementSize+=a[b][R]),!v)break;if(null!=a[b].attributes["ng-repeat-end"]||null!=a[b].attributes["data-ng-repeat-end"])break;d=!0}b++}c&&(A(),M=!1,h.$root&&!h.$root.$$phase&&h.$apply())}else var e=h.$watch(function(){(F[0].offsetHeight||F[0].offsetWidth)&&(e(),s())})})}function x(){var a="tr"===H?"":"min-";return J?a+"width":a+"height"}function y(){D()&&h.$digest()}function z(){void 0!==l.vsAutoresize&&(M=!0,s(),h.$root&&!h.$root.$$phase&&h.$apply()),D()&&h.$apply()}function A(){T=void 0,U=void 0,V=E,W=0,B(N?h.sizesCumulative[E]:h.elementSize*E),D(),h.$emit("vsRepeatReinitialized",h.startIndex,h.endIndex)}function B(a){h.totalSize=h.offsetBefore+a+h.offsetAfter}function C(){var a=d(O[0],Q);a!==X&&(A(),h.$root&&!h.$root.$$phase&&h.$apply()),X=a}function D(){var a=e(O[0],S),b=d(O[0],Q),c=F[0]===O[0]?0:f(F[0],O[0],J),i=h.startIndex,j=h.endIndex;if(N){for(i=0;h.sizesCumulative[i]<a-h.offsetBefore-c;)i++;for(i>0&&i--,i=Math.max(Math.floor(i-h.excess/2),0),j=i;h.sizesCumulative[j]<a-h.offsetBefore-c+b;)j++;j=Math.min(Math.ceil(j+h.excess/2),E)}else i=Math.max(Math.floor((a-h.offsetBefore-c)/h.elementSize)-h.excess/2,0),j=Math.min(i+Math.ceil(b/h.elementSize)+h.excess,E);V=Math.min(i,V),W=Math.max(j,W),h.startIndex=P.latch?V:i,h.endIndex=P.latch?W:j,W<h.startIndex&&(h.startIndex=W);var k=!1;if(null==T?k=!0:null==U&&(k=!0),k||(P.hunked?Math.abs(h.startIndex-T)>=h.excess/2||0===h.startIndex&&0!==T?k=!0:(Math.abs(h.endIndex-U)>=h.excess/2||h.endIndex===E&&U!==E)&&(k=!0):k=h.startIndex!==T||h.endIndex!==U),k){h[u]=I.slice(h.startIndex,h.endIndex),h.$emit("vsRepeatInnerCollectionUpdated",h.startIndex,h.endIndex,T,U);var m;l.vsScrolledToEnd&&(m=I.length-(h.scrolledToEndOffset||0),(h.endIndex>=m&&U<m||I.length&&h.endIndex===I.length)&&h.$eval(l.vsScrolledToEnd)),l.vsScrolledToBeginning&&(m=h.scrolledToBeginningOffset||0,h.startIndex<=m&&T>h.startIndex&&h.$eval(l.vsScrolledToBeginning)),T=h.startIndex,U=h.endIndex;var n=N?"(sizesCumulative[$index + startIndex] + offsetBefore)":"(($index + startIndex) * elementSize + offsetBefore)",o=g(n),p=o(h,{$index:0}),q=o(h,{$index:h[u].length}),r=h.totalSize;K.css(x(),p+"px"),L.css(x(),r-q+"px")}return k}var E,F=b.isDefined(l.vsRepeatContainer)?b.element(j[0].querySelector(l.vsRepeatContainer)):j,G=b.element(t),H=G[0].tagName.toLowerCase(),I=[],J=void 0!==l.vsHorizontal,K=b.element("<"+H+' class="vs-repeat-before-content"></'+H+">"),L=b.element("<"+H+' class="vs-repeat-after-content"></'+H+">"),M=!l.vsRepeat,N=!!l.vsSize||!!l.vsSizeProperty,O=l.vsScrollParent?"window"===l.vsScrollParent?b.element(a):i.call(F,l.vsScrollParent):F,P="vsOptions"in l?h.$eval(l.vsOptions):{},Q=J?"clientWidth":"clientHeight",R=J?"offsetWidth":"offsetHeight",S=J?"scrollLeft":"scrollTop";if(h.totalSize=0,!("vsSize"in l)&&"vsSizeProperty"in l&&console.warn("vs-size-property attribute is deprecated. Please use vs-size attribute which also accepts angular expressions."),0===O.length)throw"Specified scroll parent selector did not match any element";h.$scrollParent=O,N&&(h.sizesCumulative=[]),h.elementSize=+l.vsRepeat||d(O[0],Q)||50,h.offsetBefore=0,h.offsetAfter=0,h.excess=2,J?(K.css("height","100%"),L.css("height","100%")):(K.css("width","100%"),L.css("width","100%")),Object.keys(w).forEach(function(a){l[a]&&l.$observe(a,function(b){h[w[a]]=+b,A()})}),h.$watchCollection(o,function(a){I=a||[],r()}),G.eq(0).attr(q,n+" in "+u+(p?" "+p:"")),G.addClass("vs-repeat-repeated-element"),F.append(K),F.append(G),c(G,k)(h),F.append(L),h.startIndex=0,h.endIndex=0,O.on("scroll",y),b.element(a).on("resize",z),h.$on("$destroy",function(){b.element(a).off("resize",z),O.off("scroll",y)}),h.$on("vsRepeatTrigger",r),h.$on("vsRepeatResize",function(){M=!0,s()});var T,U,V,W;h.$on("vsRenderAll",function(){P.latch&&setTimeout(function(){var a=E;W=Math.max(a,W),h.endIndex=P.latch?W:a,h[u]=I.slice(h.startIndex,h.endIndex),U=h.endIndex,h.$$postDigest(function(){K.css(x(),0),L.css(x(),0)}),h.$apply(function(){h.$emit("vsRenderAllDone")})})});var X;h.$watch(function(){"function"==typeof a.requestAnimationFrame?a.requestAnimationFrame(C):C()})}}}}}]);"undefined"!=typeof module&&module.exports&&(module.exports=j.name)}(window,window.angular);